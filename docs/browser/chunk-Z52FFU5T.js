import{a as Z}from"./chunk-EGVOBU2V.js";import{a as X}from"./chunk-GAM3K2UG.js";import{a as Y}from"./chunk-56NZCUGG.js";import{b as P,c as D,d as q,e as U,g as $,k as j,l as R,m as z,n as G,o as H,r as J,t as K}from"./chunk-SE6REB2C.js";import{a as Q}from"./chunk-7RSTTL6O.js";import"./chunk-4IBYQYSO.js";import{a as W}from"./chunk-MJHHVN4F.js";import{$ as u,A as b,D as I,Da as T,E as y,Q as l,Ra as k,Ta as M,Ua as O,Xa as V,Z as d,ba as w,ca as E,da as B,ea as a,eb as L,fa as n,ga as p,ha as S,ia as C,ka as N,la as c,ma as f,mb as A,u as h,ua as r,va as g,x as _,z as F}from"./chunk-KT3ALLZ7.js";var ne=t=>({"background-color":t}),oe=t=>({active:t});function ae(t,o){t&1&&(a(0,"small"),r(1,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u0627\u0631\u0647 \u0645\u0637\u0644\u0648\u0628"),n())}function re(t,o){if(t&1&&(S(0),d(1,ae,2,0,"small",7),C()),t&2){let e=f();l(),u("ngIf",e.formData.controls.name.hasError("required"))}}function le(t,o){t&1&&(a(0,"small"),r(1," \u0627\u0644\u0639\u0646\u0648\u0627\u0646 \u0645\u0637\u0644\u0648\u0628"),n())}function ue(t,o){if(t&1&&(S(0),d(1,le,2,0,"small",7),C()),t&2){let e=f();l(),u("ngIf",e.formData.controls.address.hasError("required"))}}function se(t,o){if(t&1&&(a(0,"option",13),r(1),n()),t&2){let e=o.$implicit;u("value",e.id),l(),g(e.fullName)}}function me(t,o){t&1&&(a(0,"small"),r(1," \u0627\u0633\u0645 \u0627\u0644\u0645\u0627\u0644\u0643 \u0645\u0637\u0644\u0648\u0628"),n())}function de(t,o){if(t&1&&(S(0),d(1,me,2,0,"small",7),C()),t&2){let e=f();l(),u("ngIf",e.formData.controls.ownerId.hasError("required"))}}function pe(t,o){if(t&1){let e=N();a(0,"tr")(1,"th",23),r(2),n(),a(3,"td"),r(4),n(),a(5,"td"),r(6),n(),a(7,"td"),r(8),n(),a(9,"td")(10,"button",24),c("click",function(){let s=I(e).$implicit,m=f();return y(m.getUpdateData(s.id))}),p(11,"i",25),n(),a(12,"button",26),c("click",function(){let s=I(e).$implicit,m=f();return y(m.deleteData(s.id))}),p(13,"i",27),n()()()}if(t&2){let e=o.$implicit,i=o.$index;l(2),g(i+1),l(2),g(e.name),l(2),g(e.address),l(2),g(e.ownerName)}}function ce(t,o){t&1&&(a(0,"tr")(1,"td",28),p(2,"i",29)(3,"br"),r(4," \u0644\u0627 \u062A\u0648\u062C\u062F \u0628\u064A\u0627\u0646\u0627\u062A \u062D\u062A\u0649 \u0627\u0644\u0622\u0646 "),n()())}var v=class t{BuildingService=_(Z);subScription;getAllData;getAllOwnerData=[];btnText="Add";idUpdate;pageIndex=1;pageSize=10;show=!1;fb=_(J);toastr=_(Q);formData=this.fb.group({name:["",[D.required]],address:["",[D.required]],ownerId:[null,[D.required]]});title=_(L);ngOnInit(){this.title.setTitle("\u0627\u0644\u0639\u0645\u0627\u0631\u0647"),this.getDataList(),this.getDataListOwner()}getDataList(){this.subScription=this.BuildingService.getDataList().subscribe(o=>{this.getAllData=o})}getDataListOwner(){let o={pageIndex:this.pageIndex,pageSize:this.pageSize};this.subScription=this.BuildingService.getDataListOwner(o).subscribe(e=>{this.getAllOwnerData=e.rows})}onSubmit(){if(this.formData.valid){let o={name:this.formData.get("name")?.value||"",address:this.formData.get("address")?.value||"",ownerId:this.formData.get("ownerId")?.value||""};this.btnText=="Add"?(this.subScription=this.BuildingService.addData(o).subscribe({next:e=>{this.toastr.show("\u062A\u0645 \u0627\u0636\u0627\u0641\u0647 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0628\u0646\u062C\u0627\u062D","success"),this.getDataList()},error:e=>{if(e.error.errors){let i=e.error.errors;for(let s in i)i[s].forEach(ie=>{this.toastr.show(ie,"error")})}else this.toastr.show("\u062D\u062F\u062B \u062E\u0637\u0623 \u0623\u062B\u0646\u0627\u0621 \u0627\u0644\u0639\u0645\u0644\u064A\u0629","error")}}),this.formData.reset()):this.subScription=this.BuildingService.updateData(this.idUpdate,o).subscribe(e=>{this.getDataList(),this.toastr.show("\u062A\u0645 \u062A\u0639\u062F\u064A\u0644 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A \u0628\u0646\u062C\u0627\u062D","success"),this.formData.reset(),this.btnText="Add"})}else this.formData.markAllAsTouched()}getUpdateData(o){this.btnText="Update",this.idUpdate=o,this.subScription=this.BuildingService.getUpdateData(o).subscribe(e=>{console.log(e),this.formData.patchValue({name:e.name,address:e.address,ownerId:e.ownerId})})}resetData(){this.btnText="Add"}deleteId;onClose(){this.show=!1}deleteConfirmed(o){console.log(this.deleteId),this.show=!1,this.subScription=this.BuildingService.deleteData(this.deleteId).subscribe({next:e=>{this.getDataList(),this.toastr.show("\u062A\u0645 \u062D\u0630\u0641 \u0627\u0644\u0628\u064A\u0627\u0646\u0627\u062A","success")},error:e=>{this.toastr.show("\u0644\u0627 \u064A\u0645\u0643\u0646 \u062D\u0630\u0641 \u0627\u0644\u0639\u0646\u0635\u0631 \u0625\u0630\u0627 \u0643\u0627\u0646 \u0628\u0647 \u062D\u0631\u0643\u0627\u062A","error")}})}deleteData(o){this.show=!0,this.deleteId=o}ngOnDestroy(){this.subScription&&this.subScription.unsubscribe()}onPageChanged(o){this.pageIndex=o,this.getDataList()}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=F({type:t,selectors:[["app-building"]],decls:52,vars:16,consts:[["appIntersection","fade-in",1,"title-page"],["src","assets/dashboard/iconarrowdouble.png","alt","icon",1,"mx-1"],["appIntersection","fade-in",1,"forms_dashboard",3,"ngSubmit","formGroup"],[1,"row"],[1,"mb-3","col-sm-12","col-md-6","col-lg-4"],["for","namebuilding",1,"form-label"],["type","text","id","namebuilding","placeholder","\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u0627\u0631\u0647","formControlName","name",1,"form-control"],[4,"ngIf"],["for","address",1,"form-label"],["type","text","id","address","placeholder","\u0627\u0644\u0639\u0646\u0648\u0627\u0646","formControlName","address",1,"form-control"],["for","username",1,"form-label"],["id","username","aria-label","Default select example","formControlName","ownerId",1,"form-select"],["value","","disabled","","selected",""],[3,"value"],[1,"btn_add_reset"],["type","reset",3,"click"],["type","submit",3,"ngStyle"],["appIntersection","fade-in",1,"table-responsive"],[1,"table","table-striped","mt-4"],["scope","col"],[1,"modal_delete",3,"ngClass"],[3,"toggleModal","onDelete","isVisible","itemId"],[3,"pageChange","totalPages","currentPage"],["scope","row"],[1,"btn","btn-success","ms-3",3,"click"],[1,"fa-solid","fa-pen-to-square"],[1,"btn","btn-danger",3,"click"],[1,"fa-solid","fa-trash"],["colspan","5",1,"text-center","py-5",2,"color","#888","font-size","18px"],[1,"fa-solid","fa-circle-exclamation","fa-2x","mb-2",2,"color","#ccc"]],template:function(e,i){e&1&&(a(0,"h3",0),r(1,"\u0627\u0644\u0631\u0626\u064A\u0633\u064A\u0647 "),p(2,"img",1),a(3,"span"),r(4,"\u0627\u0644\u0639\u0645\u0627\u0631\u0647"),n()(),a(5,"form",2),c("ngSubmit",function(){return i.onSubmit()}),a(6,"div",3)(7,"div",4)(8,"label",5),r(9,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u0627\u0631\u0647"),n(),p(10,"input",6),d(11,re,2,1,"ng-container",7),n(),a(12,"div",4)(13,"label",8),r(14,"\u0627\u0644\u0639\u0646\u0648\u0627\u0646"),n(),p(15,"input",9),d(16,ue,2,1,"ng-container",7),n(),a(17,"div",4)(18,"label",10),r(19,"\u0627\u0633\u0645 \u0627\u0644\u0645\u0627\u0644\u0643"),n(),a(20,"select",11)(21,"option",12),r(22,"\u0627\u0644\u0627\u0633\u0645"),n(),E(23,se,2,2,"option",13,w),n(),d(25,de,2,1,"ng-container",7),n()(),a(26,"div",14)(27,"button",15),c("click",function(){return i.resetData()}),r(28,"\u062C\u062F\u064A\u062F"),n(),a(29,"button",16),r(30),n()()(),a(31,"div",17)(32,"table",18)(33,"thead")(34,"tr")(35,"th",19),r(36,"\u0645"),n(),a(37,"th",19),r(38,"\u0627\u0633\u0645 \u0627\u0644\u0639\u0645\u0627\u0631\u0647"),n(),a(39,"th",19),r(40,"\u0627\u0644\u0639\u0646\u0648\u0627\u0646"),n(),a(41,"th",19),r(42," \u0627\u0633\u0645 \u0627\u0644\u0645\u0627\u0644\u0643"),n(),a(43,"th",19),r(44,"\u0627\u0644\u0627\u062F\u0648\u0627\u062A"),n()()(),a(45,"tbody"),E(46,pe,14,4,"tr",null,w,!1,ce,5,0,"tr"),n()()(),a(49,"div",20)(50,"app-confirm-delete",21),c("toggleModal",function(){return i.onClose()})("onDelete",function(m){return i.deleteConfirmed(m)}),n()(),a(51,"app-pagination",22),c("pageChange",function(m){return i.onPageChanged(m)}),n()),e&2&&(l(5),u("formGroup",i.formData),l(6),u("ngIf",i.formData.controls.name.invalid&&i.formData.controls.name.touched),l(5),u("ngIf",i.formData.controls.address.invalid&&i.formData.controls.address.touched),l(7),B(i.getAllOwnerData),l(2),u("ngIf",i.formData.controls.ownerId.invalid&&i.formData.controls.ownerId.touched),l(4),u("ngStyle",T(12,ne,i.btnText=="Add"?"#16601A":"#fd7e14")),l(),g(i.btnText=="Add"?"\u0627\u0636\u0627\u0641\u0647":"\u062A\u0639\u062F\u064A\u0644"),l(16),B(i.getAllData==null?null:i.getAllData.rows),l(3),u("ngClass",T(14,oe,i.show)),l(),u("isVisible",i.show)("itemId",i.deleteId),l(),u("totalPages",i.getAllData==null||i.getAllData.paginationInfo==null?null:i.getAllData.paginationInfo.totalPagesCount)("currentPage",i.pageIndex))},dependencies:[k,M,O,$,G,H,P,z,q,U,j,R,X,W,Y]})};var ge=[{path:"",component:v}],x=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=b({type:t});static \u0275inj=h({imports:[A.forChild(ge),A]})};var te=class t{static \u0275fac=function(e){return new(e||t)};static \u0275mod=b({type:t});static \u0275inj=h({imports:[V,x,K]})};export{te as BuildingModule};
